<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.5
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame" src="file_list.html"></iframe>

      <div id="content"><div id='filecontents'>
<h1 id="label-Cassandra">Cassandra</h1>

<p><a href="https://forge.puppetlabs.com/locp/cassandra"><img
src="http://img.shields.io/puppetforge/v/locp/cassandra.svg"></a> <a
href="https://github.com/locp/cassandra"><img
src="https://img.shields.io/github/tag/locp/cassandra.svg"></a> <a
href="https://travis-ci.org/locp/cassandra"><img
src="https://travis-ci.org/locp/cassandra.png?branch=master"></a> <a
href="https://coveralls.io/github/locp/cassandra?branch=master"><img
src="https://coveralls.io/repos/locp/cassandra/badge.svg?branch=master&service=github"></a>
<a
href="https://gitter.im/locp/cassandra?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge"><img
src="https://badges.gitter.im/Join%20Chat.svg"></a></p>

<h4 id="label-Table+of+Contents">Table of Contents</h4>
<ol><li>
<p><a href="#overview">Overview</a></p>
</li><li>
<p><a href="#setup">Setup - The basics of getting started with Cassandra</a></p>
<ul><li>
<p><a href="#what-cassandra-affects">What Cassandra affects</a></p>
</li><li>
<p><a href="#upgrading">Upgrading</a></p>
</li><li>
<p><a href="#beginning-with-cassandra">Beginning with Cassandra</a></p>
</li></ul>
</li><li>
<p><a href="#usage">Usage - Configuration options and additional
functionality</a></p>
<ul><li>
<p><a href="#setup-a-keyspace-and-users">Setup a keyspace and users</a></p>
</li><li>
<p><a href="#create-a-cluster-in-a-single-data-center">Create a Cluster in a
Single Data Center</a></p>
</li><li>
<p><a href="#create-a-cluster-in-multiple-data-centers">Create a Cluster in
Multiple Data Centers</a></p>
</li><li>
<p><a href="#datastax-enterprise">DataStax Enterprise</a></p>
</li></ul>
</li><li>
<p><a href="#reference">Reference</a></p>
</li><li>
<p><a href="#limitations">Limitations - OS compatibility, etc.</a></p>
</li><li>
<p><a href="#contributers">Contributers</a></p>
</li></ol>

<h2 id="label-Overview">Overview</h2>

<p>A Puppet module to install and manage Cassandra, DataStax Agent &amp;
OpsCenter</p>

<h2 id="label-Setup">Setup</h2>

<h3 id="label-What+Cassandra+affects">What Cassandra affects</h3>

<h4 id="label-What+the+Cassandra+class+affects">What the Cassandra class affects</h4>
<ul><li>
<p>Installs the Cassandra package (default <strong>cassandra22</strong> on Red
Hat and  <strong>cassandra</strong> on Debian).</p>
</li><li>
<p>Configures settings in <em>$config_path/cassandra.yaml</em>.</p>
</li><li>
<p>On CentOS 7 if the <code>init</code> service provider is used, then
cassandra  is added as a system service.</p>
</li><li>
<p>Optionally ensures that the Cassandra service is enabled and running.</p>
</li><li>
<p>On Debian systems:</p>
</li><li>
<p>Optionally replace <code>/etc/init.d/cassandra</code> with a workaround for
<a
href="https://issues.apache.org/jira/browse/CASSANDRA-9822">CASSANDRA-9822</a>.</p>
</li></ul>

<h4 id="label-What+the+cassandra%3A%3Adatastax_agent+class+affects">What the cassandra::datastax_agent class affects</h4>
<ul><li>
<p>Optionally installs the DataStax agent.</p>
</li><li>
<p>Optionally sets JAVA_HOME in <strong>/etc/default/datastax-agent</strong>.</p>
</li></ul>

<h4 id="label-What+the+cassandra%3A%3Adatastax_repo+class+affects">What the cassandra::datastax_repo class affects</h4>
<ul><li>
<p>Optionally configures a Yum repository to install the Cassandra packages 
from (on Red Hat).</p>
</li><li>
<p>Optionally configures an Apt repository to install the Cassandra packages 
from (on Debian).</p>
</li></ul>

<h4 id="label-What+the+cassandra%3A%3Afirewall_ports+class+affects">What the cassandra::firewall_ports class affects</h4>
<ul><li>
<p>Optionally configures the firewall for the Cassandra related network 
ports.</p>
</li></ul>

<h4 id="label-What+the+cassandra%3A%3Ajava+class+affects">What the cassandra::java class affects</h4>
<ul><li>
<p>Optionally installs a JRE/JDK package (e.g. java-1.7.0-openjdk) and the 
Java Native Access (JNA).</p>
</li></ul>

<h4 id="label-What+the+cassandra%3A%3Aoptutils+class+affects">What the cassandra::optutils class affects</h4>
<ul><li>
<p>Optionally installs the Cassandra support tools (e.g. cassandra22-tools).</p>
</li></ul>

<h3 id="label-Upgrading">Upgrading</h3>

<p>We follow <a href="http://semver.org/">SemVer Versioning</a> and an update
of the major release (i.e. from 1.<em>Y</em>.<em>Z</em> to
2.<em>Y</em>.<em>Z</em>) will indicate a significant change to the API
which will most probably require a change to your manifest.</p>

<h4 id="label-Changes+in+2.0.0">Changes in 2.0.0</h4>

<p>This is a major change to the API and you will more than likely need to
change your manifest to accomodate these changes.</p>

<p>The <code>service_ensure</code> attribute of the cassandra class now
defaults to <em>undef</em>, users who do want to manage service status in
Puppet can still set it to true. If leaving the value at the default and
setting <code>service_refresh</code> and <code>service_enable</code> to
false will mean that the user and not Puppet running will control the
running state of Cassandra. This currently works OK on the Red Hat family,
but has issues on Debian due to <a
href="https://issues.apache.org/jira/browse/CASSANDRA-2356">CASSANDRA-2356</a>
during an initial install or package upgrade.</p>

<p>All the functionality relating to OpsCenter has been divested to the <a
href="https://forge.puppet.com/locp/opscenter">locp/opscenter</a> module on
Puppet Forge.</p>

<p>It should also be noted that the module no longer creates directories for
the <code>data</code>, <code>commitlog</code>, <code>saved_caches</code>
and for Cassandra 3 the <code>hints</code> directory. These resources will
now need to be defined in your manifest/profile.</p>

<p>For a list of features that have been deprecated in this release, please
see <a
href="https://github.com/locp/cassandra/wiki/Deprecations">github.com/locp/cassandra/wiki/Deprecations</a></p>

<p>For details on migrating from the version 1.X.X attributes to the
<code>settings</code> hash, see <a
href="https://github.com/locp/cassandra/wiki/Version-1.X.Y-Template-Defaults-Shown-As-2.X.Y-Hash">github.com/locp/cassandra/wiki/Version-1.X.Y-Template-Defaults-Shown-As-2.X.Y-Hash</a></p>

<p>Please also see the notes for 2.0.0 in the <a
href="https://forge.puppet.com/locp/cassandra/changelog">CHANGELOG</a>.</p>

<h4 id="label-Changes+in+1.19.0">Changes in 1.19.0</h4>

<p>The hints_directory documentation will cause a change in the cassandra.yaml
file regardless of the value you set it to. If you do not wish this to
result in a refesh of the Cassandra service, please set service_refresh to
false.</p>

<h4 id="label-Changes+in+1.9.2">Changes in 1.9.2</h4>

<p>Now that Cassandra 3 is available from the DataStax repositories, there is
a problem (especially on Debian) with the operating system package manager
attempting to install Cassandra 3. This can be mitigated against using
something similar to the code in this modules acceptance test. Please note
that the default Cassandra package name has now been changed from
&#39;dsc&#39;. See the documentation for cassandra::package_name below for
details.</p>

<pre class="code ruby"><code class="ruby">if $::osfamily == &#39;RedHat&#39; {
   $version = &#39;2.2.4-1&#39;
 } else {
   $version = &#39;2.2.4&#39;
 }

 class { &#39;cassandra&#39;:
   package_ensure =&gt; $version,
 }
</code></pre>

<h4 id="label-Changes+in+1.8.0">Changes in 1.8.0</h4>

<p>A somewhat embarrassing correction to the spelling of the
cassandra::fail_on_non_suppoted_os to cassandra::fail_on_non_supported_os.</p>

<h4 id="label-Issues+when+Upgrading+to+1.4.0">Issues when Upgrading to 1.4.0</h4>

<p>Unfortunately both releases 1.3.7 and 1.4.0 have subsequently been found to
call a refresh service even when no changes had been made to the underlying
configuration. In release 1.8.0 (somewhat belatedly) the service_refresh
flag has been introduced to mitigate against similar problems.</p>

<h4 id="label-Issues+When+Upgrading+to+1.3.7">Issues When Upgrading to 1.3.7</h4>
<ul><li>
<p>Please see the notes for 1.4.0.</p>
</li></ul>

<h4 id="label-Changes+in+1.0.0">Changes in 1.0.0</h4>
<ul><li>
<p>cassandra::cassandra_package_ensure has been renamed to 
cassandra::package_ensure.</p>
</li><li>
<p>cassandra::cassandra_package_name has been renamed to 
cassandra::package_name.</p>
</li></ul>

<h4 id="label-Changes+in+0.4.0">Changes in 0.4.0</h4>

<p>There is now a cassandra::datastax_agent class, therefore:</p>
<ul><li>
<p>cassandra::datastax_agent_package_ensure has now been replaced with 
cassandra::datastax_agent::package_ensure.</p>
</li><li>
<p>cassandra::datastax_agent_service_enable has now been replaced with 
cassandra::datastax_agent::service_enable.</p>
</li><li>
<p>cassandra::datastax_agent_service_ensure has now been replaced with 
cassandra::datastax_agent::service_ensure.</p>
</li><li>
<p>cassandra::datastax_agent_package_name has now been replaced with 
cassandra::datastax_agent::package_name.</p>
</li><li>
<p>cassandra::datastax_agent_service_name has now been replaced with 
cassandra::datastax_agent::service_name.</p>
</li></ul>

<p>Likewise now there is a new class for handling the installation of Java:</p>
<ul><li>
<p>cassandra::java_package_ensure has now been replaced with 
cassandra::java::ensure.</p>
</li><li>
<p>cassandra::java_package_name has now been replaced with 
cassandra::java::package_name.</p>
</li></ul>

<p>Also there is now a class for installing the optional utilities:</p>
<ul><li>
<p>cassandra::cassandra_opt_package_ensure has now been replaced with 
cassandra::optutils:ensure.</p>
</li><li>
<p>cassandra::cassandra_opt_package_name has now been replaced with 
cassandra::optutils:package_name.</p>
</li></ul>

<h4 id="label-Changes+in+0.3.0">Changes in 0.3.0</h4>
<ul><li>
<p>cassandra_opt_package_ensure changed from &#39;present&#39; to undef.</p>
</li><li>
<p>The manage_service option has been replaced with service_enable and 
service_ensure.</p>
</li></ul>

<h3 id="label-Beginning+with+Cassandra">Beginning with Cassandra</h3>

<p>Create a Cassandra 2.X cluster called MyCassandraCluster which uses the
GossipingPropertyFileSnitch and password authentication. In this very basic
example the node itself becomes a seed for the cluster and the credentials
will default to a user called cassandra with a password called of
cassandra..</p>

<pre class="code ruby"><code class="ruby"># Cassandra pre-requisites
include cassandra::datastax_repo
include cassandra::java

class { &#39;cassandra&#39;:
  settings =&gt; {
    &#39;authenticator&#39;               =&gt; &#39;PasswordAuthenticator&#39;,
    &#39;cluster_name&#39;                =&gt; &#39;MyCassandraCluster&#39;,
    &#39;commitlog_directory&#39;         =&gt; &#39;/var/lib/cassandra/commitlog&#39;,
    &#39;commitlog_sync&#39;              =&gt; &#39;periodic&#39;,
    &#39;commitlog_sync_period_in_ms&#39; =&gt; 10000,
    &#39;data_file_directories&#39;       =&gt; [&#39;/var/lib/cassandra/data&#39;],
    &#39;endpoint_snitch&#39;             =&gt; &#39;GossipingPropertyFileSnitch&#39;,
    &#39;listen_address&#39;              =&gt; $::ipaddress,
    &#39;partitioner&#39;                 =&gt; &#39;org.apache.cassandra.dht.Murmur3Partitioner&#39;,
    &#39;saved_caches_directory&#39;      =&gt; &#39;/var/lib/cassandra/saved_caches&#39;,
    &#39;seed_provider&#39;               =&gt; [
      {
        &#39;class_name&#39; =&gt; &#39;org.apache.cassandra.locator.SimpleSeedProvider&#39;,
        &#39;parameters&#39; =&gt; [
          {
            &#39;seeds&#39; =&gt; $::ipaddress,
          },
        ],
      },
    ],
    &#39;start_native_transport&#39;      =&gt; true,
  },
  require  =&gt; Class[&#39;cassandra::datastax_repo&#39;, &#39;cassandra::java&#39;],
}
</code></pre>

<p>For this code to run with version 3.X of Cassandra, the
<code>hints_directory</code> will also need to be specified:</p>

<pre class="code ruby"><code class="ruby">...

class { &#39;cassandra&#39;:
  settings =&gt; {
    ...
    &#39;hints_directory&#39;             =&gt; &#39;/var/lib/cassandra/hints&#39;,
    ...
  },
  require  =&gt; Class[&#39;cassandra::datastax_repo&#39;, &#39;cassandra::java&#39;],
}
</code></pre>

<h2 id="label-Usage">Usage</h2>

<h3 id="label-Setup+a+keyspace+and+users">Setup a keyspace and users</h3>

<p>We assume that authentication has been enabled for the cassandra cluster
and we are connecting with the default user name and password
(&#39;cassandra/cassandra&#39;).</p>

<p>In this example, we create a keyspace (mykeyspace) with a table called
&#39;users&#39; and an index called &#39;users_lname_idx&#39;.</p>

<p>We also add three users (to Cassandra, not the mykeyspace.users table)
called spillman, akers and boone while ensuring that a user called lucan is
absent.</p>

<pre class="code ruby"><code class="ruby">class { &#39;cassandra&#39;:
  ...
}

class { &#39;cassandra::schema&#39;:
  cqlsh_password =&gt; &#39;cassandra&#39;,
  cqlsh_user     =&gt; &#39;cassandra&#39;,
  cqlsh_host     =&gt; $::ipaddress,
  indexes        =&gt; {
    &#39;users_lname_idx&#39; =&gt; {
      table    =&gt; &#39;users&#39;,
      keys     =&gt; &#39;lname&#39;,
      keyspace =&gt; &#39;mykeyspace&#39;,
    },
  },
  keyspaces      =&gt; {
    &#39;mykeyspace&#39; =&gt; {
      durable_writes  =&gt; false,
      replication_map =&gt; {
        keyspace_class     =&gt; &#39;SimpleStrategy&#39;,
        replication_factor =&gt; 1,
      },
    }
  },
  tables         =&gt; {
    &#39;users&#39; =&gt; {
      columns  =&gt; {
        user_id       =&gt; &#39;int&#39;,
        fname         =&gt; &#39;text&#39;,
        lname         =&gt; &#39;text&#39;,
        &#39;PRIMARY KEY&#39; =&gt; &#39;(user_id)&#39;,
      },
      keyspace =&gt; &#39;mykeyspace&#39;,
    },
  },
  users          =&gt; {
    &#39;spillman&#39; =&gt; {
      password =&gt; &#39;Niner27&#39;,
    },
    &#39;akers&#39;    =&gt; {
      password  =&gt; &#39;Niner2&#39;,
      superuser =&gt; true,
    },
    &#39;boone&#39;    =&gt; {
      password =&gt; &#39;Niner75&#39;,
    },
    &#39;lucan&#39;    =&gt; {
      &#39;ensure&#39; =&gt; absent
    },
  },
}
</code></pre>

<h3 id="label-Create+a+Cluster+in+a+Single+Data+Center">Create a Cluster in a Single Data Center</h3>

<p>In the DataStax documentation <em>Initializing a multiple node cluster
(single data center)</em> <a
href="http://docs.datastax.com/en/cassandra/2.2/cassandra/initialize/initSingleDS.html">docs.datastax.com/en/cassandra/2.2/cassandra/initialize/initSingleDS.html</a>
there is a basic example of a six node cluster with two seeds to be created
in a single data center spanning two racks. The nodes in the cluster are:</p>

<p><strong>Node Name</strong> | <strong>IP Address</strong> | —————|—————-|
node0 (seed 1) | 110.82.155.0 | node1 | 110.82.155.1 | node2 | 110.82.155.2
| node3 (seed 2) | 110.82.156.3 | node4 | 110.82.156.4 | node5 |
110.82.156.5 |</p>

<p>Each node is configured to use the GossipingPropertyFileSnitch and 256
virtual nodes (vnodes). The name of the cluster is
<em>MyCassandraCluster</em>. Also, while building the initial cluster, we
are setting the auto_bootstrap to false.</p>

<p>In this initial example, we are going to expand the example by:</p>
<ul><li>
<p>Ensuring that the software is installed via the DataStax Community 
repository by including <code>cassandra::datastax_repo</code>. This needs
to be  executed before the Cassandra package is installed.</p>
</li><li>
<p>That a suitable Java Runtime environment (JRE) is installed with Java
Native  Access (JNA) by including <code>cassandra::java</code>. This need
to be executed  before the Cassandra service is started.</p>
</li></ul>

<pre class="code ruby"><code class="ruby">node /^node\d+$/ {
  class { &#39;cassandra::datastax_repo&#39;:
    before =&gt; Class[&#39;cassandra&#39;]
  }

  class { &#39;cassandra::java&#39;:
    before =&gt; Class[&#39;cassandra&#39;]
  }

  class { &#39;cassandra&#39;:
    settings       =&gt; {
      &#39;authenticator&#39;               =&gt; &#39;AllowAllAuthenticator&#39;,
      &#39;auto_bootstrap&#39;              =&gt; false,
      &#39;cluster_name&#39;                =&gt; &#39;MyCassandraCluster&#39;,
      &#39;commitlog_directory&#39;         =&gt; &#39;/var/lib/cassandra/commitlog&#39;,
      &#39;commitlog_sync&#39;              =&gt; &#39;periodic&#39;,
      &#39;commitlog_sync_period_in_ms&#39; =&gt; 10000,
      &#39;data_file_directories&#39;       =&gt; [&#39;/var/lib/cassandra/data&#39;],
      &#39;endpoint_snitch&#39;             =&gt; &#39;GossipingPropertyFileSnitch&#39;,
      &#39;hints_directory&#39;             =&gt; &#39;/var/lib/cassandra/hints&#39;,
      &#39;listen_interface&#39;            =&gt; &#39;eth1&#39;,
      &#39;num_tokens&#39;                  =&gt; 256,
      &#39;partitioner&#39;                 =&gt; &#39;org.apache.cassandra.dht.Murmur3Partitioner&#39;,
      &#39;saved_caches_directory&#39;      =&gt; &#39;/var/lib/cassandra/saved_caches&#39;,
      &#39;seed_provider&#39;               =&gt; [
        {
          &#39;class_name&#39; =&gt; &#39;org.apache.cassandra.locator.SimpleSeedProvider&#39;,
          &#39;parameters&#39; =&gt; [
            {
              &#39;seeds&#39; =&gt; &#39;110.82.155.0,110.82.156.3&#39;,
            },
          ],
        },
      ],
      &#39;start_native_transport&#39;      =&gt; true,
    },
  }
}
</code></pre>

<p>The default value for the num_tokens is already 256, but it is included in
the example for clarity. Do not forget to either set auto_bootstrap to true
or not set the attribute at all after initializing the cluster.</p>

<h3 id="label-Create+a+Cluster+in+Multiple+Data+Centers">Create a Cluster in Multiple Data Centers</h3>

<p>To continue with the examples provided by DataStax, we look at the example
for a cluster across multiple data centers <a
href="http://docs.datastax.com/en/cassandra/2.2/cassandra/initialize/initMultipleDS.html">docs.datastax.com/en/cassandra/2.2/cassandra/initialize/initMultipleDS.html</a>.</p>

<p><strong>Node Name</strong> | <strong>IP Address</strong> | <strong>Data
Center</strong> | <strong>Rack</strong> | —————|—————-|—————–|———-| node0
(seed 1) | 10.168.66.41 | DC1 | RAC1 | node1 | 10.176.43.66 | DC1 | RAC1 |
node2 | 10.168.247.41 | DC1 | RAC1 | node3 (seed 2) | 10.176.170.59 | DC2 |
RAC1 | node4 | 10.169.61.170 | DC2 | RAC1 | node5 | 10.169.30.138 | DC2 |
RAC1 |</p>

<p>For the sake of simplicity, we will confine this example to the nodes:</p>

<pre class="code ruby"><code class="ruby">node /^node[012]$/ {
  class { &#39;cassandra&#39;:
    dc             =&gt; &#39;DC1&#39;,
    settings       =&gt; {
      &#39;authenticator&#39;               =&gt; &#39;AllowAllAuthenticator&#39;,
      &#39;auto_bootstrap&#39;              =&gt; false,
      &#39;cluster_name&#39;                =&gt; &#39;MyCassandraCluster&#39;,
      &#39;commitlog_directory&#39;         =&gt; &#39;/var/lib/cassandra/commitlog&#39;,
      &#39;commitlog_sync&#39;              =&gt; &#39;periodic&#39;,
      &#39;commitlog_sync_period_in_ms&#39; =&gt; 10000,
      &#39;data_file_directories&#39;       =&gt; [&#39;/var/lib/cassandra/data&#39;],
      &#39;endpoint_snitch&#39;             =&gt; &#39;GossipingPropertyFileSnitch&#39;,
      &#39;hints_directory&#39;             =&gt; &#39;/var/lib/cassandra/hints&#39;,
      &#39;listen_interface&#39;            =&gt; &#39;eth1&#39;,
      &#39;num_tokens&#39;                  =&gt; 256,
      &#39;partitioner&#39;                 =&gt; &#39;org.apache.cassandra.dht.Murmur3Partitioner&#39;,
      &#39;saved_caches_directory&#39;      =&gt; &#39;/var/lib/cassandra/saved_caches&#39;,
      &#39;seed_provider&#39;               =&gt; [
        {
          &#39;class_name&#39; =&gt; &#39;org.apache.cassandra.locator.SimpleSeedProvider&#39;,
          &#39;parameters&#39; =&gt; [
            {
              &#39;seeds&#39; =&gt; &#39;110.82.155.0,110.82.156.3&#39;,
            },
          ],
        },
      ],
      &#39;start_native_transport&#39;      =&gt; true,
    },
  }
}

node /^node[345]$/ {
  class { &#39;cassandra&#39;:
    dc             =&gt; &#39;DC2&#39;,
    settings       =&gt; {
      &#39;authenticator&#39;               =&gt; &#39;AllowAllAuthenticator&#39;,
      &#39;auto_bootstrap&#39;              =&gt; false,
      &#39;cluster_name&#39;                =&gt; &#39;MyCassandraCluster&#39;,
      &#39;commitlog_directory&#39;         =&gt; &#39;/var/lib/cassandra/commitlog&#39;,
      &#39;commitlog_sync&#39;              =&gt; &#39;periodic&#39;,
      &#39;commitlog_sync_period_in_ms&#39; =&gt; 10000,
      &#39;data_file_directories&#39;       =&gt; [&#39;/var/lib/cassandra/data&#39;],
      &#39;endpoint_snitch&#39;             =&gt; &#39;GossipingPropertyFileSnitch&#39;,
      &#39;hints_directory&#39;             =&gt; &#39;/var/lib/cassandra/hints&#39;,
      &#39;listen_interface&#39;            =&gt; &#39;eth1&#39;,
      &#39;num_tokens&#39;                  =&gt; 256,
      &#39;partitioner&#39;                 =&gt; &#39;org.apache.cassandra.dht.Murmur3Partitioner&#39;,
      &#39;saved_caches_directory&#39;      =&gt; &#39;/var/lib/cassandra/saved_caches&#39;,
      &#39;seed_provider&#39;               =&gt; [
        {
          &#39;class_name&#39; =&gt; &#39;org.apache.cassandra.locator.SimpleSeedProvider&#39;,
          &#39;parameters&#39; =&gt; [
            {
              &#39;seeds&#39; =&gt; &#39;110.82.155.0,110.82.156.3&#39;,
            },
          ],
        },
      ],
      &#39;start_native_transport&#39;      =&gt; true,
    },
  }
}
</code></pre>

<p>We don&#39;t need to specify the rack name (with the rack attribute) as
RAC1 is the default value. Again, do not forget to either set
auto_bootstrap to true or not set the attribute at all after initializing
the cluster.</p>

<h2 id="label-Reference">Reference</h2>

<h3 id="label-Public+Classes">Public Classes</h3>
<ul><li>
<p><a href="#class-cassandra">cassandra</a></p>
</li><li>
<p><a href="#class-cassandradatastax_agent">cassandra::datastax_agent</a></p>
</li><li>
<p><a href="#class-cassandradatastax_repo">cassandra::datastax_repo</a></p>
</li><li>
<p><a href="#class-cassandrafirewall_ports">cassandra::firewall_ports</a></p>
</li><li>
<p><a href="#class-cassandrajava">cassandra::java</a></p>
</li><li>
<p><a href="#class-cassandraoptutils">cassandra::optutils</a></p>
</li><li>
<p><a href="#class-cassandraschema">cassandra::schema</a></p>
</li></ul>

<h3 id="label-Public+Defined+Types">Public Defined Types</h3>
<ul><li>
<p><a href="#defined-type-cassandrafile">cassandra::file</a></p>
</li><li>
<p><a
href="#defined-type-cassandraschemacql_type">cassandra::schema::cql_type</a></p>
</li><li>
<p><a href="#defined-type-cassandraschemaindex">cassandra::schema::index</a></p>
</li><li>
<p><a
href="#defined-type-cassandraschemakeyspace">cassandra::schema::keyspace</a></p>
</li><li>
<p><a href="#defined-type-cassandraschematable">cassandra::schema::table</a></p>
</li><li>
<p><a href="#defined-type-cassandraschemauser">cassandra::schema::user</a></p>
</li></ul>

<h3 id="label-Private+Defined+Types">Private Defined Types</h3>
<ul><li>
<p><a
href="#defined-type-cassandraprivatedeprecation_warning">cassandra::private::deprecation_warning</a></p>
</li><li>
<p><a
href="#defined-type-cassandraprivatefirewall_portsrule">cassandra::private::firewall_ports::rule</a></p>
</li></ul>

<h3 id="label-Facts">Facts</h3>
<ul><li>
<p>cassandramajorversion</p>
</li><li>
<p>cassandraminorversion</p>
</li><li>
<p>cassandrapatchversion</p>
</li><li>
<p>cassandrarelease</p>
</li></ul>

<h3 id="label-Attributes">Attributes</h3>

<p>A class for installing the Cassandra package and manipulate settings in the
configuration file.</p>

<h4 id="label-Class%3A+cassandra">Class: cassandra</h4>

<h5 id="label-cassandra_2356_sleep_seconds"><code>cassandra_2356_sleep_seconds</code></h5>

<p>This will provide a workaround for <a
href="https://issues.apache.org/jira/browse/CASSANDRA-2356">CASSANDRA-2356</a>
by sleeping for the specifed number of seconds after an event involving the
Cassandra package.</p>

<p>This option is silently ignored on the Red Hat family of operating systems
as this bug only affects Debian systems. Default value 5</p>

<h5 id="label-cassandra_9822"><code>cassandra_9822</code></h5>

<p>If set to true, this will apply a patch to the init file for the Cassandra
service as a workaround for <a
href="https://issues.apache.org/jira/browse/CASSANDRA-9822">CASSANDRA-9822</a>.
This option is silently ignored on the Red Hat family of operating systems
as this bug only affects Debian systems. Default value &#39;false&#39;</p>

<h5 id="label-cassandra_yaml_tmpl"><code>cassandra_yaml_tmpl</code></h5>

<p>The path to the Puppet template for the Cassandra configuration file. This
allows the user to supply their own customized template. Default value
&#39;cassandra/cassandra.yaml.erb&#39;</p>

<h5 id="label-config_file_mode"><code>config_file_mode</code></h5>

<p>The permissions mode of the cassandra configuration file. Default value
&#39;0644&#39;</p>

<h5 id="label-config_path"><code>config_path</code></h5>

<p>The path to the cassandra configuration file. Default value
<strong>/etc/cassandra/default.conf</strong> on Red Hat or
<strong>/etc/cassandra</strong> on Debian.</p>

<h5 id="label-dc"><code>dc</code></h5>

<p>Sets the value for dc in
<em>config_path</em>/<em>snitch_properties_file</em> see <a
href="http://docs.datastax.com/en/cassandra/2.1/cassandra/architecture/architectureSnitchesAbout_c.html">docs.datastax.com/en/cassandra/2.1/cassandra/architecture/architectureSnitchesAbout_c.html</a>
for more details. Default value &#39;DC1&#39;</p>

<h5 id="label-dc_suffix"><code>dc_suffix</code></h5>

<p>Sets the value for dc_suffix in
<em>config_path</em>/<em>snitch_properties_file</em> see <a
href="http://docs.datastax.com/en/cassandra/2.1/cassandra/architecture/architectureSnitchesAbout_c.html">docs.datastax.com/en/cassandra/2.1/cassandra/architecture/architectureSnitchesAbout_c.html</a>
for more details. If the value is <em>undef</em> then change will be made
to the snitch properties file for this setting. Default value
<em>undef</em></p>

<h5 id="label-fail_on_non_supported_os"><code>fail_on_non_supported_os</code></h5>

<p>A flag that dictates if the module should fail if it is not RedHat or
Debian. If you set this option to false then you must also at least set the
<code>config_path</code> attribute as well. Default value &#39;true&#39;</p>

<h5 id="label-package_ensure"><code>package_ensure</code></h5>

<p>The status of the package specified in <strong>package_name</strong>. Can
be <em>present</em>, <em>latest</em> or a specific version number. Default
value &#39;present&#39;</p>

<h5 id="label-package_name"><code>package_name</code></h5>

<p>The name of the Cassandra package which must be available from a
repository. Default value <strong>cassandra22</strong> on the Red Hat
family of operating systems or <strong>cassandra</strong> on Debian.</p>

<h5 id="label-prefer_local"><code>prefer_local</code></h5>

<p>Sets the value for prefer_local in
<em>config_path</em>/<em>snitch_properties_file</em> see <a
href="http://docs.datastax.com/en/cassandra/2.1/cassandra/architecture/architectureSnitchesAbout_c.html">docs.datastax.com/en/cassandra/2.1/cassandra/architecture/architectureSnitchesAbout_c.html</a>
for more details. Valid values are true, false or <em>undef</em>. If the
value is <em>undef</em> then change will be made to the snitch properties
file for this setting. Default value <em>undef</em></p>

<h5 id="label-rack"><code>rack</code></h5>

<p>Sets the value for rack in
<em>config_path</em>/<em>snitch_properties_file</em> see <a
href="http://docs.datastax.com/en/cassandra/2.1/cassandra/architecture/architectureSnitchesAbout_c.html">docs.datastax.com/en/cassandra/2.1/cassandra/architecture/architectureSnitchesAbout_c.html</a>
for more details. Default value &#39;RAC1&#39;</p>

<h5 id="label-rackdc_tmpl"><code>rackdc_tmpl</code></h5>

<p>The template for creating the snitch properties file. Default value
&#39;cassandra/cassandra-rackdc.properties.erb&#39;</p>

<h5 id="label-service_enable"><code>service_enable</code></h5>

<p>Enable the Cassandra service to start at boot time. Valid values are true
or false. Default value &#39;true&#39;</p>

<h5 id="label-service_ensure"><code>service_ensure</code></h5>

<p>Ensure the Cassandra service is running. Valid values are running or
stopped. Default value <em>undef</em></p>

<h5 id="label-service_name"><code>service_name</code></h5>

<p>The name of the service that runs the Cassandra software. Default value
&#39;cassandra&#39;</p>

<h5 id="label-service_provider"><code>service_provider</code></h5>

<p>The name of the provider that runs the service. If left as <em>undef</em>
then the OS family specific default will be used, otherwise the specified
value will be used instead. Default value <em>undef</em></p>

<h5 id="label-service_refresh"><code>service_refresh</code></h5>

<p>If set to true, changes to the Cassandra config file or the data
directories will ensure that Cassandra service is refreshed after the
changes. Setting this flag to false will disable this behaviour, therefore
allowing the changes to be made but allow the user to control when the
service is restarted. Default value true</p>

<h5 id="label-settings"><code>settings</code></h5>

<p>A hash that is passed to <code>to_yaml</code> which dumps the results to
the Cassandra configuring file. The minimum required settings for Cassandra
2.X are as follows:</p>

<pre class="code ruby"><code class="ruby">{
  &#39;authenticator&#39;               =&gt; &#39;PasswordAuthenticator&#39;,
  &#39;cluster_name&#39;                =&gt; &#39;MyCassandraCluster&#39;,
  &#39;commitlog_directory&#39;         =&gt; &#39;/var/lib/cassandra/commitlog&#39;,
  &#39;commitlog_sync&#39;              =&gt; &#39;periodic&#39;,
  &#39;commitlog_sync_period_in_ms&#39; =&gt; 10000,
  &#39;data_file_directories&#39;       =&gt; [&#39;/var/lib/cassandra/data&#39;],
  &#39;endpoint_snitch&#39;             =&gt; &#39;GossipingPropertyFileSnitch&#39;,
  &#39;listen_address&#39;              =&gt; $::ipaddress,
  &#39;partitioner&#39;                 =&gt; &#39;org.apache.cassandra.dht.Murmur3Partitioner&#39;,
  &#39;saved_caches_directory&#39;      =&gt; &#39;/var/lib/cassandra/saved_caches&#39;,
  &#39;seed_provider&#39;               =&gt; [
    {
      &#39;class_name&#39; =&gt; &#39;org.apache.cassandra.locator.SimpleSeedProvider&#39;,
      &#39;parameters&#39; =&gt; [
        {
          &#39;seeds&#39; =&gt; $::ipaddress,
        },
      ],
    },
  ],
  &#39;start_native_transport&#39;      =&gt; true,
}
</code></pre>

<p>For Cassandra 3.X you will also need to specify the
<code>hints_directory</code> attribute. Default value {}</p>

<h5 id="label-snitch_properties_file"><code>snitch_properties_file</code></h5>

<p>The name of the snitch properties file. The full path name would be
<em>config_path</em>/<em>snitch_properties_file</em>. Default value
&#39;cassandra-rackdc.properties&#39;</p>

<h4 id="label-Class%3A+cassandra%3A%3Adatastax_agent">Class: cassandra::datastax_agent</h4>

<p>A class for installing the DataStax Agent and to point it at an OpsCenter
instance.</p>

<p>In this example set agent_alias to foobar, stomp_interface to localhost and
ensure that async_pool_size is absent from the file:</p>

<pre class="code ruby"><code class="ruby">class { &#39;cassandra::datastax_agent&#39;:
  settings =&gt; {
    &#39;agent_alias&#39;     =&gt; {
      &#39;setting&#39; =&gt; &#39;agent_alias&#39;,
      &#39;value&#39;   =&gt; &#39;foobar&#39;,
    },
    &#39;stomp_interface&#39; =&gt; {
      &#39;setting&#39; =&gt; &#39;stomp_interface&#39;,
      &#39;value&#39;   =&gt; &#39;localhost&#39;,
    },
    &#39;async_pool_size&#39; =&gt; {
      &#39;ensure&#39; =&gt; absent,
    },
  },
}
</code></pre>

<h5 id="label-address_config_file"><code>address_config_file</code></h5>

<p>The full path to the address config file. Default value
&#39;/var/lib/datastax-agent/conf/address.yaml&#39;</p>

<h5 id="label-defaults_file"><code>defaults_file</code></h5>

<p>The full path name to the file where <code>java_home</code> is set. Default
value &#39;/etc/default/datastax-agent&#39;</p>

<h5 id="label-java_home"><code>java_home</code></h5>

<p>If the value of this variable is left as <em>undef</em>, no action is
taken. Otherwise the value is set as JAVA_HOME in
<code>defaults_file</code>. Default value <em>undef</em></p>

<h5 id="label-package_ensure"><code>package_ensure</code></h5>

<p>Is passed to the package reference. Valid values are
<strong>present</strong> or a version number. Default value
&#39;present&#39;</p>

<h5 id="label-package_name"><code>package_name</code></h5>

<p>Is passed to the package reference. Default value &#39;datastax-agent&#39;</p>

<h5 id="label-service_ensure"><code>service_ensure</code></h5>

<p>Is passed to the service reference. Default value &#39;running&#39;</p>

<h5 id="label-service_enable"><code>service_enable</code></h5>

<p>Is passed to the service reference. Default value &#39;true&#39;</p>

<h5 id="label-service_name"><code>service_name</code></h5>

<p>Is passed to the service reference. Default value &#39;datastax-agent&#39;</p>

<h5 id="label-service_provider"><code>service_provider</code></h5>

<p>The name of the provider that runs the service. If left as <em>undef</em>
then the OS family specific default will be used, otherwise the specified
value will be used instead. Default value <em>undef</em></p>

<h5 id="label-settings"><code>settings</code></h5>

<p>A hash that is passed to <a
href="https://github.com/puppetlabs/puppetlabs-inifile#function-create_ini_settings">create_ini_settings</a>
with the following additional defaults:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
  <span class='id identifier rubyid_path'>path</span>              <span class='op'>=&gt;</span> <span class='gvar'>$address_config_file</span><span class='comma'>,</span>
  <span class='id identifier rubyid_key_val_separator'>key_val_separator</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>: </span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='id identifier rubyid_require'>require</span>           <span class='op'>=&gt;</span> <span class='const'>Package</span><span class='lbracket'>[</span><span class='gvar'>$package_name</span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='id identifier rubyid_notify'>notify</span>            <span class='op'>=&gt;</span> <span class='const'>Service</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>datastax-agent</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
<span class='rbrace'>}</span>
</code></pre>

<p>Default value {}</p>

<h4 id="label-Class%3A+cassandra%3A%3Adatastax_repo">Class: cassandra::datastax_repo</h4>

<p>An optional class that will allow a suitable repository to be configured
from which packages for DataStax Community can be downloaded. Changing the
defaults will allow any Debian Apt or Red Hat Yum repository to be
configured.</p>

<h5 id="label-descr"><code>descr</code></h5>

<p>On the Red Hat family, this is passed as the <code>descr</code> attribute
to a <code>yumrepo</code> resource. On the Debian family, it is passed as
the <code>comment</code> attribute to an <code>apt::source</code> resource.
Default value &#39;DataStax Repo for Apache Cassandra&#39;</p>

<h5 id="label-key_id"><code>key_id</code></h5>

<p>On the Debian family, this is passed as the <code>id</code> attribute to an
<code>apt::key</code> resource. On the Red Hat family, it is ignored.
Default value &#39;7E41C00F85BFC1706C4FFFB3350200F2B999A372&#39;</p>

<h5 id="label-key_url"><code>key_url</code></h5>

<p>On the Debian family, this is passed as the <code>source</code> attribute
to an <code>apt::key</code> resource. On the Red Hat family, it is ignored.
Default value &#39;<a
href="http://debian.datastax.com/debian/repo_key">debian.datastax.com/debian/repo_key</a>&#39;</p>

<h5 id="label-pkg_url"><code>pkg_url</code></h5>

<p>If left as the default, this will set the <code>baseurl</code> to &#39;<a
href="http://rpm.datastax.com/community">rpm.datastax.com/community</a>&#39;
on a <code>yumrepo</code> resource on the Red Hat family. On the Debian
family, leaving this as the default will set the <code>location</code>
attribute on an <code>apt::source</code> to &#39;<a
href="http://debian.datastax.com/community">debian.datastax.com/community</a>&#39;.
Default value <em>undef</em></p>

<h5 id="label-release"><code>release</code></h5>

<p>On the Debian family, this is passed as the <code>release</code> attribute
to an <code>apt::source</code> resource. On the Red Hat family, it is
ignored. Default value &#39;stable&#39;</p>

<h4 id="label-Defined+Type%3A+cassandra%3A%3Afile">Defined Type: cassandra::file</h4>

<p>A definition for altering files relative to the configuration directory.
For example set the MAX_HEAP_SIZE and and HEAP_NEWSIZE for the JVM
depending on the memory and number of processors on the node:</p>

<pre class="code ruby"><code class="ruby">if $::memorysize_mb &lt; 24576.0 {
  $max_heap_size_in_mb = floor($::memorysize_mb / 2)
} elsif $::memorysize_mb &lt; 8192.0 {
  $max_heap_size_in_mb = floor($::memorysize_mb / 4)
} else {
  $max_heap_size_in_mb = 8192
}

$heap_new_size = $::processorcount * 100

cassandra::file { &quot;Set Java/Cassandra max heap size to ${max_heap_size_in_mb}.&quot;:
  file       =&gt; &#39;cassandra-env.sh&#39;,
  file_lines =&gt; {
    &#39;MAX_HEAP_SIZE&#39; =&gt; {
      line  =&gt; &quot;MAX_HEAP_SIZE=&#39;${max_heap_size_in_mb}M&#39;&quot;,
      match =&gt; &#39;^#?MAX_HEAP_SIZE=.*&#39;,
    },
  }
}

cassandra::file { &quot;Set Java/Cassandra heap new size to ${heap_new_size}.&quot;:
  file       =&gt; &#39;cassandra-env.sh&#39;,
  file_lines =&gt; {
    &#39;HEAP_NEWSIZE&#39;  =&gt; {
      line  =&gt; &quot;HEAP_NEWSIZE=&#39;${heap_new_size}M&#39;&quot;,
      match =&gt; &#39;^#?HEAP_NEWSIZE=.*&#39;,
    }
  }
}

$tmpdir = &#39;/var/lib/cassandra/tmp&#39;

file { $tmpdir:
  ensure =&gt; directory,
  owner  =&gt; &#39;cassandra&#39;,
  group  =&gt; &#39;cassandra&#39;,
}

cassandra::file { &#39;Set java.io.tmpdir&#39;:
  file       =&gt; &#39;jvm.options&#39;,
  file_lines =&gt; {
    &#39;java.io.tmpdir&#39; =&gt; {
      line =&gt; &quot;-Djava.io.tmpdir=${tmpdir}&quot;,
    },
  },
  require    =&gt; File[$tmpdir],
}
</code></pre>

<h5 id="label-file"><code>file</code></h5>

<p>The name of the file relative to the <code>config_path</code>. This
defaults to the title of the definition.</p>

<h5 id="label-config_path"><code>config_path</code></h5>

<p>The path to the configuration directory. On the RedHat family this will
default to <code>/etc/cassandra/default.conf</code> on Debian, the default
is <code>/etc/cassandra</code>.</p>

<h5 id="label-file_lines"><code>file_lines</code></h5>

<p>If set, then the <a
href="https://docs.puppet.com/puppet/latest/reference/function.html#createresources">create_resources</a>
will be used to create an array of <a
href="https://forge.puppet.com/puppetlabs/stdlib#file_line">file_line</a>
resources where the path attribute is set to
<code>${config_path}/${file}</code> Default <em>undef</em></p>

<h5 id="label-service_refresh"><code>service_refresh</code></h5>

<p>If the Cassandra service is to be notified if the environment file is
changed. Set to false if this is not wanted. Default value true.</p>

<h4 id="label-Class%3A+cassandra%3A%3Afirewall_ports">Class: cassandra::firewall_ports</h4>

<p>An optional class to configure incoming network ports on the host that are
relevant to the Cassandra installation. If firewalls are being managed
already, simply do not include this module in your manifest.</p>

<p>IMPORTANT: The full list of which ports should be configured is assessed at
evaluation time of the configuration. Therefore if one is to use this
class, it must be the final cassandra class included in the manifest.</p>

<h5 id="label-client_ports"><code>client_ports</code></h5>

<p>Only has any effect if the <code>cassandra</code> class is defined on the
node.</p>

<p>Allow these TCP ports to be opened for traffic coming from the client
subnets. Default value &#39;[9042, 9160]&#39;</p>

<h5 id="label-client_subnets"><code>client_subnets</code></h5>

<p>Only has any effect if the <code>cassandra</code> class is defined on the
node.</p>

<p>An array of the list of subnets that are to allowed connection to
cassandra::native_transport_port and cassandra::rpc_port. Default value
&#39;[&#39;0.0.0.0/0&#39;]&#39;</p>

<h5 id="label-inter_node_ports"><code>inter_node_ports</code></h5>

<p>Only has any effect if the <code>cassandra</code> class is defined on the
node.</p>

<p>Allow these TCP ports to be opened for traffic between the Cassandra nodes.
Default value &#39;[7000, 7001, 7199]&#39;</p>

<h5 id="label-inter_node_ports"><code>inter_node_ports</code></h5>

<p>Allow these TCP ports to be opened for traffic coming from OpsCenter
subnets. Default value &#39;[7000, 7001, 7199]&#39;</p>

<h5 id="label-inter_node_subnets"><code>inter_node_subnets</code></h5>

<p>Only has any effect if the <code>cassandra</code> class is defined on the
node.</p>

<p>An array of the list of subnets that are to allowed connection to
cassandra::storage_port, cassandra::ssl_storage_port and port 7199 for
cassandra JMX monitoring. Default value &#39;[&#39;0.0.0.0/0&#39;]&#39;</p>

<h5 id="label-public_ports"><code>public_ports</code></h5>

<p>Allow these TCP ports to be opened for traffic coming from public subnets
the port specified in <code>$ssh_port</code> will be appended to this list.
Default value &#39;[8888]&#39;</p>

<h5 id="label-public_subnets"><code>public_subnets</code></h5>

<p>An array of the list of subnets that are to allowed connection to
cassandra::firewall_ports::ssh_port. Default value
&#39;[&#39;0.0.0.0/0&#39;]&#39;</p>

<h5 id="label-ssh_port"><code>ssh_port</code></h5>

<p>Which port does SSH operate on. Default value &#39;22&#39;</p>

<h5 id="label-opscenter_ports"><code>opscenter_ports</code></h5>

<p>Only has any effect if the <code>cassandra::datastax_agent</code> is
defined.</p>

<p>Allow these TCP ports to be opened for traffic coming to or from OpsCenter
appended to this list. Default value [9042, 9160, 61620, 61621]</p>

<h5 id="label-opscenter_subnets"><code>opscenter_subnets</code></h5>

<p>A list of subnets that are to be allowed connection to port 61621 for nodes
built with cassandra::datastax_agent. Default value
&#39;[&#39;0.0.0.0/0&#39;]&#39;</p>

<h4 id="label-Class%3A+cassandra%3A%3Ajava">Class: cassandra::java</h4>

<p>A class to install an appropriate Java package.</p>

<h5 id="label-aptkey"><code>aptkey</code></h5>

<p>If supplied, this should be a hash of <em>apt::key</em> resources that will
be passed to the create_resources function. This is ignored on non-Debian
systems. Default value <em>undef</em></p>

<h5 id="label-aptsource"><code>aptsource</code></h5>

<p>If supplied, this should be a hash of <em>apt::source</em> resources that
will be passed to the create_resources function. This is ignored on non-Red
Hat systems. Default value <em>undef</em></p>

<h5 id="label-jna_ensure"><code>jna_ensure</code></h5>

<p>Is passed to the package reference for the JNA package. Valid values are
<strong>present</strong> or a version number. Default value
&#39;present&#39;</p>

<h5 id="label-jna_package_name"><code>jna_package_name</code></h5>

<p>The name of the JNA package. Default value jna or libjna-java will be
installed on a Red Hat family or Debian system respectively.</p>

<h5 id="label-package_ensure"><code>package_ensure</code></h5>

<p>Is passed to the package reference for the JRE/JDK package. Valid values
are <strong>present</strong> or a version number. Default value
&#39;present&#39;</p>

<h5 id="label-package_name"><code>package_name</code></h5>

<p>The name of the Java package to be installed. Default value
java-1.8.0-openjdk-headless on Red Hat openjdk-7-jre-headless on Debian.</p>

<h5 id="label-yumrepo"><code>yumrepo</code></h5>

<p>If supplied, this should be a hash of <em>yumrepo</em> resources that will
be passed to the create_resources function. This is ignored on non-Red Hat
systems. Default value <em>undef</em></p>

<h4 id="label-Class%3A+cassandra%3A%3Aoptutils">Class: cassandra::optutils</h4>

<p>A class to install the optional Cassandra tools package.</p>

<h5 id="label-package_ensure"><code>package_ensure</code></h5>

<p>The status of the package specified in <strong>package_name</strong>. Can
be <em>present</em>, <em>latest</em> or a specific version number. Default
value &#39;present&#39;</p>

<h5 id="label-package_name"><code>package_name</code></h5>

<p>The name of the optional utilities package to be installed. This defaults
to <code>cassandra22-tools</code> or <code>cassandra-tools</code> on a Red
Hat family or Debian system respectively.</p>

<h4 id="label-Class%3A+cassandra%3A%3Aschema">Class: cassandra::schema</h4>

<p>A class to maintain the database schema. Please note that cqlsh expects
Python 2.7 to be installed. This may be a problem of older distributions
(CentOS 6 for example).</p>

<h5 id="label-connection_tries"><code>connection_tries</code></h5>

<p>How many times do try to connect to Cassandra. See also
<code>connection_try_sleep</code>.</p>

<p>Default value 6</p>

<h5 id="label-connection_try_sleep"><code>connection_try_sleep</code></h5>

<p>How much time to allow between the number of tries specified in
<code>connection_tries</code>.</p>

<p>Default value 30</p>

<h5 id="label-cql_types"><code>cql_types</code></h5>

<p>Creates new <code>cassandra::schema::cql_type</code> resources. Valid
options: a hash to be passed to the <code>create_resources</code> function.
Default: {}.</p>

<h5 id="label-cqlsh_additional_options"><code>cqlsh_additional_options</code></h5>

<p>Any additional options to be passed to the <strong>cqlsh</strong> command.</p>

<p>Default value &#39;&#39;</p>

<h5 id="label-cqlsh_client_config"><code>cqlsh_client_config</code></h5>

<p>Set this to a file name (e.g. <strong>/root/.puppetcqlshrc</strong>) that
will then be used to contain the credentials for connecting to Cassandra.
This is a more secure option than having the credentials appearing on the
command line. This option is only available in Cassandra 2.1.</p>

<p>Default value <em>undef</em></p>

<h5 id="label-cqlsh_client_tmpl"><code>cqlsh_client_tmpl</code></h5>

<p>The location of the template for configuring the credentials for the cqlsh
client. This is ignored unless <code>cqlsh_client_config</code> is set.</p>

<p>Default value &#39;cassandra/cqlshrc.erb&#39;</p>

<h5 id="label-cqlsh_command"><code>cqlsh_command</code></h5>

<p>The full path to the <strong>cqlsh</strong> command.</p>

<p>Default value &#39;/usr/bin/cqlsh&#39;</p>

<h5 id="label-cqlsh_host"><code>cqlsh_host</code></h5>

<p>The host for the <strong>cqlsh</strong> command to connect to. See also
<code>cqlsh_port</code>.</p>

<p>Default value &#39;localhost&#39;</p>

<h5 id="label-cqlsh_password"><code>cqlsh_password</code></h5>

<p>If credentials are require for connecting, specify the password here. See
also <code>cqlsh_user</code>. See also <code>cqlsh_client_config</code>.</p>

<p>Default value <em>undef</em></p>

<h5 id="label-cqlsh_port"><code>cqlsh_port</code></h5>

<p>The host for the <strong>cqlsh</strong> command to connect to. See also
<code>cqlsh_host</code>. See also <code>cqlsh_host</code>.</p>

<p>Default value 9042</p>

<h5 id="label-cqlsh_user"><code>cqlsh_user</code></h5>

<p>If credentials are require for connecting, specify the password here. See
also <code>cqlsh_password</code>. See also
<code>cqlsh_client_config</code>.</p>

<p>Default value &#39;cassandra&#39;</p>

<h5 id="label-indexes"><code>indexes</code></h5>

<p>Creates new <code>cassandra::schema::indexes</code> resources. Valid
options: a hash to be passed to the <code>create_resources</code> function.
Default: {}.</p>

<h5 id="label-keyspaces"><code>keyspaces</code></h5>

<p>Creates new <code>cassandra::schema::keyspace</code> resources. Valid
options: a hash to be passed to the <code>create_resources</code> function.
Default: {}.</p>

<h5 id="label-tables"><code>tables</code></h5>

<p>Creates new <code>cassandra::schema::table</code> resources. Valid options:
a hash to be passed to the <code>create_resources</code> function. Default:
{}.</p>

<h5 id="label-users"><code>users</code></h5>

<p>Creates new <code>cassandra::schema::user</code> resources. Valid options:
a hash to be passed to the <code>create_resources</code> function. Default:
{}.</p>

<h4 id="label-Defined+Type+cassandra%3A%3Aschema%3A%3Acql_type">Defined Type cassandra::schema::cql_type</h4>

<p>Create or drop user defined data types within the schema. Please see the <a
href="#beginning-with-cassandra">Begining with Cassandra</a> section of
this document.</p>

<h5 id="label-keyspace"><code>keyspace</code></h5>

<p>The name of the keyspace that the data type is to be associated with.</p>

<h5 id="label-ensure"><code>ensure</code></h5>

<p>Valid values can be <strong>present</strong> to ensure a data type is
created, or <strong>absent</strong> to ensure it is dropped.</p>

<h5 id="label-fields"><code>fields</code></h5>

<p>A hash of the fields that will be components for the data type. See the
example earlier in this document for the layout of the hash.</p>

<h5 id="label-cql_type_name"><code>cql_type_name</code></h5>

<p>The name of the CQL type to be created. Defaults to the title of the
resource.</p>

<h4 id="label-Defined+Type+cassandra%3A%3Aschema%3A%3Aindex">Defined Type cassandra::schema::index</h4>

<p>Create or drop indexes within the schema. Please see the <a
href="#beginning-with-cassandra">Begining with Cassandra</a> section of
this document.</p>

<h5 id="label-ensure"><code>ensure</code></h5>

<p>Valid values can be <strong>present</strong> to ensure an index is created,
or <strong>absent</strong> to ensure it is dropped.</p>

<h5 id="label-class_name"><code>class_name</code></h5>

<p>The name of the class to be associated with an index when creating a custom
index.</p>

<p>Default value <em>undef</em></p>

<h5 id="label-index"><code>index</code></h5>

<p>The name of the index. Defaults to the name of the resource. Set to
<em>undef</em> if the index is not to have a name.</p>

<h5 id="label-keys"><code>keys</code></h5>

<p>The columns that the index is being created on.</p>

<p>Default value <em>undef</em></p>

<h5 id="label-keyspace"><code>keyspace</code></h5>

<p>The name of the keyspace that the index is to be associated with.</p>

<h5 id="label-options"><code>options</code></h5>

<p>Any options to be added to the index.</p>

<p>Default value <em>undef</em></p>

<h5 id="label-table"><code>table</code></h5>

<p>The name of the table that the index is to be associated with.</p>

<h4 id="label-Defined+Type+cassandra%3A%3Aschema%3A%3Akeyspace">Defined Type cassandra::schema::keyspace</h4>

<p>Create or drop keyspaces within the schema. Please see the example code in
the <a href="#beginning-with-cassandra">Begining with Cassandra</a> section
of this document.</p>

<h5 id="label-ensure"><code>ensure</code></h5>

<p>Valid values can be <strong>present</strong> to ensure a keyspace is
created, or <strong>absent</strong> to ensure it is dropped.</p>

<h5 id="label-durable_writes"><code>durable_writes</code></h5>

<p>When set to false, data written to the keyspace bypasses the commit log. Be
careful using this option because you risk losing data. Set this attribute
to false on a keyspace using the SimpleStrategy. Default value true.</p>

<h5 id="label-keyspace_name"><code>keyspace_name</code></h5>

<p>The name of the keyspace to be created. Defaults to the name of the
resource.</p>

<h5 id="label-replication_map"><code>replication_map</code></h5>

<p>Needed if the keyspace is to be present. Optional if it is to be absent.
Can be something like the following:</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$network_topology_strategy</span> <span class='op'>=</span> <span class='lbrace'>{</span>
  <span class='id identifier rubyid_keyspace_class'>keyspace_class</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NetworkTopologyStrategy</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='id identifier rubyid_dc1'>dc1</span>            <span class='op'>=&gt;</span> <span class='int'>3</span><span class='comma'>,</span>
  <span class='id identifier rubyid_dc2'>dc2</span>            <span class='op'>=&gt;</span> <span class='int'>2</span>
<span class='rbrace'>}</span>
</code></pre>

<h4 id="label-Defined+Type+cassandra%3A%3Aschema%3A%3Atable">Defined Type cassandra::schema::table</h4>

<p>Create or drop tables within the schema. Please see the example code in the
<a href="#beginning-with-cassandra">Begining with Cassandra</a> section of
this document.</p>

<h5 id="label-keyspace"><code>keyspace</code></h5>

<p>The name of the keyspace. This value is taken from the title given to the
<code>cassandra::schema::keyspace</code> resource.</p>

<h5 id="label-columns"><code>columns</code></h5>

<p>A hash of the columns to be placed in the table. Optional if the table is
to be absent.</p>

<p>Default value {}</p>

<h5 id="label-ensure"><code>ensure</code></h5>

<p>Valid values can be <strong>present</strong> to ensure a keyspace is
created, or <strong>absent</strong> to ensure it is dropped.</p>

<p>Default value <strong>present</strong></p>

<h5 id="label-options"><code>options</code></h5>

<p>Options to be added to the table creation.</p>

<p>Default value []</p>

<h5 id="label-table"><code>table</code></h5>

<p>The name of the table. Defaults to the name of the resource.</p>

<h4 id="label-Defined+Type+cassandra%3A%3Aschema%3A%3Auser">Defined Type cassandra::schema::user</h4>

<p>Create or drop users. Please see the example code in the <a
href="#beginning-with-cassandra">Begining with Cassandra</a> section of
this document. To use this class, a suitable <code>authenticator</code>
(e.g. PasswordAuthenticator) must be set in the Cassandra class.</p>

<h5 id="label-ensure"><code>ensure</code></h5>

<p>Valid values can be <strong>present</strong> to ensure a user is created,
or <strong>absent</strong> to remove the user if it exists. Default value
true.</p>

<h5 id="label-password"><code>password</code></h5>

<p>A password for the user. Default value <em>undef</em>.</p>

<h5 id="label-superuser"><code>superuser</code></h5>

<p>If the user is to be a super-user on the system. Default value false.</p>

<h5 id="label-user_name"><code>user_name</code></h5>

<p>The name of the user. Defaults to the title of the resource.</p>

<h4 id="label-Defined+Type+cassandra%3A%3Aprivate%3A%3Adeprecation_warning">Defined Type cassandra::private::deprecation_warning</h4>

<p>A defined type to handle deprecation messages to the user. This is not
intended to be used by a user but is documented here for completeness.</p>

<h5 id="label-item_number"><code>item_number</code></h5>

<p>A unique reference number for the specific deprecation.</p>

<h4 id="label-Defined+Type+cassandra%3A%3Aprivate%3A%3Afirewall_ports%3A%3Arule">Defined Type cassandra::private::firewall_ports::rule</h4>

<p>A defined type to be used as a macro for setting host based firewall rules.
This is not intended to be used by a user (who should use the API provided
by cassandra::firewall_ports instead) but is documented here for
completeness.</p>

<h5 id="label-title"><code>title</code></h5>

<p>A text field that contains the protocol name and CIDR address of a subnet.</p>

<h5 id="label-port"><code>port</code></h5>

<p>The number(s) of the port(s) to be opened.</p>

<h2 id="label-Limitations">Limitations</h2>

<p>When using a Ruby version before 1.9.0, the contents of the Cassandra
configuration file may change order of elementsdue to a problem with
to_yaml in earlier versions of Ruby.</p>

<p>When creating key spaces, indexes, cql_types and users the settings will
only be used to create a new resource if it does not currently exist. If a
change is made to the Puppet manifest but the resource already exits, this
change will not be reflected.</p>

<h2 id="label-Contributers">Contributers</h2>

<p>Contributions will be gratefully accepted. Please go to the project page,
fork the project, make your changes locally and then raise a pull request.
Details on how to do this are available at <a
href="https://guides.github.com/activities/contributing-to-open-source">guides.github.com/activities/contributing-to-open-source</a>.</p>

<p>Please also see the <a
href="https://github.com/locp/cassandra/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a>
page for project specific requirements.</p>

<h3 id="label-Additional+Contributers">Additional Contributers</h3>

<p><strong>Release</strong> | <strong>PR/Issue</strong> |
<strong>Contributer</strong> ————-|—————————————————–|—————————————————-
2.0.2 | <a href="https://github.com/locp/cassandra/issues/291">#291</a>| <a
href="https://github.com/ericy-jana">@ericy-jana</a> 2.0.0 | <a
href="https://github.com/locp/cassandra/issues/266">#266</a>| <a
href="https://github.com/stanleyz">@stanleyz</a> 1.25.2 | <a
href="https://github.com/locp/cassandra/issues/269">#269</a>| <a
href="https://github.com/ahharu">@ahharu</a> 1.25.1 | <a
href="https://github.com/locp/cassandra/issues/264">#264</a>| <a
href="https://github.com/pampelix">@pampelix</a> 1.25.0 | <a
href="https://github.com/locp/cassandra/pull/261">#261</a> | <a
href="https://github.com/tibers">@tibers</a> 1.24.0 | <a
href="https://github.com/locp/cassandra/pull/247">#247</a> | <a
href="https://github.com/ericy-jana">@ericy-jana</a> 1.24.0 | <a
href="https://github.com/locp/cassandra/pull/246">#246</a> | <a
href="https://github.com/ericy-jana">@ericy-jana</a> 1.24.0 | <a
href="https://github.com/locp/cassandra/issues/245">#245</a>| <a
href="https://github.com/ericy-jana">@ericy-jana</a> 1.23.0 | <a
href="https://github.com/locp/cassandra/pull/235">#235</a> | <a
href="https://github.com/tibers">@tibers</a> 1.22.1 | <a
href="https://github.com/locp/cassandra/pull/233">#233</a> | <a
href="https://github.com/tibers">@tibers</a> 1.22.1 | <a
href="https://github.com/locp/cassandra/issues/232">#232</a>| <a
href="https://github.com/tibers">@tibers</a> 1.21.0 | <a
href="https://github.com/locp/cassandra/pull/226">#226</a> | <a
href="https://github.com/tibers">@tibers</a> 1.20.0 | <a
href="https://github.com/locp/cassandra/issues/217">#217</a>| <a
href="https://github.com/samyray">@samyray</a> 1.19.0 | <a
href="https://github.com/locp/cassandra/pull/215">#215</a> | <a
href="https://github.com/tibers">@tibers</a> 1.18.0 | <a
href="https://github.com/locp/cassandra/pull/203">#203</a> | <a
href="https://github.com/Mike-Petersen">@Mike-Petersen</a> 1.15.0 | <a
href="https://github.com/locp/cassandra/pull/189">#189</a> | <a
href="https://github.com/tibers">@tibers</a> 1.14.0 | <a
href="https://github.com/locp/cassandra/pull/171">#171</a> | <a
href="https://github.com/jonen10">@jonen10</a> 1.13.0 | <a
href="https://github.com/locp/cassandra/pull/166">#166</a> | <a
href="https://github.com/Mike-Petersen">@Mike-Petersen</a> 1.13.0 | <a
href="https://github.com/locp/cassandra/pull/163">#163</a> | <a
href="https://github.com/VeriskPuppet">@VeriskPuppet</a> 1.12.2 | <a
href="https://github.com/locp/cassandra/pull/165">#165</a> | <a
href="https://github.com/palmertime">@palmertime</a> 1.12.0 | <a
href="https://github.com/locp/cassandra/pull/156">#156</a> | <a
href="https://github.com/stuartbfox">@stuartbfox</a> 1.12.0 | <a
href="https://github.com/locp/cassandra/pull/153">#153</a> | <a
href="https://github.com/Mike-Petersen">@Mike-Petersen</a> 1.10.0 | <a
href="https://github.com/locp/cassandra/pull/144">#144</a> | <a
href="https://github.com/Mike-Petersen">@Mike-Petersen</a> 1.9.2 | <a
href="https://github.com/locp/cassandra/issues/136">#136</a>| <a
href="https://github.com/mantunovic">@mantunovic</a> 1.9.2 | <a
href="https://github.com/locp/cassandra/issues/136">#136</a>| <a
href="https://github.com/al4">@al4</a> 1.4.2 | <a
href="https://github.com/locp/cassandra/pull/110">#110</a> | <a
href="https://github.com/markasammut">@markasammut</a> 1.4.0 | <a
href="https://github.com/locp/cassandra/pull/100">#100</a> | <a
href="https://github.com/markasammut">@markasammut</a> 1.3.5 | <a
href="https://github.com/locp/cassandra/issues/93">#93</a> | <a
href="https://github.com/sampowers">@sampowers</a> 1.3.3 | <a
href="https://github.com/locp/cassandra/pull/87">#87</a> | <a
href="https://github.com/DylanGriffith">@DylanGriffith</a> 0.4.2 | <a
href="https://github.com/locp/cassandra/pull/34">#34</a> | <a
href="https://github.com/amosshapira">@amosshapira</a> 0.3.0 | <a
href="https://github.com/locp/cassandra/pull/11">#11</a> | <a
href="https://github.com/Spredzy">@spredzy</a></p>
</div></div>

      <div id="footer">
  Generated on Wed Oct 19 21:58:34 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.5 (ruby-2.1.6).
</div>

    </div>
  </body>
</html>